
/*!
 * Queiroz.js 3.0.4
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(e){var t={name:"Queiroz.js",version:"3.0.4",description:"Queiroz.js 3.0.4",module:{},settings:{USERSCRIPT_DELAY_MILLIS:1e3,MAX_CONSECUTIVE_MINUTES:360,WEEKLY_GOAL_MINUTES:2640,DAILY_GOAL_MINUTES:528,WORK_DAYS:[1,2,3,4,5],INITIAL_WEEKDAY:1}};e.Queiroz=t}(window),function(e,t){var n=function(){return{backWeek:function(){e.mudarSemana(-1,!0)},nextWeek:function(){e.mudarSemana(1,!0)}}}();t.module.kairos=n}(window,Queiroz),function(e){var t=function(e){return t._[e]};t._={pending:"Pendente",extra:"Extra",balance:"Saldo",labor:"Efetuado",working:"Trabalhando...",exit:"Saída (08:48)","exit+":"Saída + Saldo"},e.module.strings=t}(Queiroz),function(e){var t={CSS:"html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}#SemanaApontamentos{cursor:default!important}.ContentTable{margin-top:inherit}.FilledSlot,.LastSlot,.emptySlot{height:inherit;padding:5px}.FilledSlot span{margin:inherit!important}.qz-text-center{text-align:center}.qz-text-primary{color:brown}.qz-text-golden{color:#b8860b}.qz-text-green{color:green}.qz-text-teal{color:teal}.qz-box{padding:5px 10px;margin:5px 1px;border:#a9a9a9 1px solid;min-width:60px}.qz-box-compact{min-width:auto}.qz-box-inline{display:inline-block}.qz-box-head{float:right}.qz-box-muted{background-color:#d3d3d3}.qz-box .qz-box-content{vertical-align:middle}.qz-help-text{font-size:10px}.qz-toggle{margin-top:10px}.fa-toggle-on{color:green}.fa-toggle-off{color:grey}.js-show{display:block}.js-hide{display:none}.qz-modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1024;background-color:rgba(0,0,0,.5)}.qz-modal-dialog{position:relative;width:900px;margin:30px auto}.qz-modal-content{position:relative;background-color:#fff;background-clip:padding-box;border-radius:5px}.qz-modal-header{padding:10px;border-bottom:1px solid #d3d3d3;font-weight:700;font-size:16px}.qz-modal-close{float:right;cursor:pointer;background:0 0;border:0;padding:0;color:silver}.qz-modal-body{padding:10px}.qz-modal-footer{padding:10px;border-top:1px solid #d3d3d3;text-align:center}"};e.module.style=t}(Queiroz),function(e,t){var n=t.module.strings,i=t.module.style,o={DIV:"div",P:"p",SPAN:"span",STYLE:"style",STRONG:"strong",BUTTON:"button",SMALL:"small",TABLE:"table",THEAD:"thead",TBODY:"tbody",TH:"th",TR:"tr",TD:"td"},a=function(){var a=function(t,n,i){var o=e.createElement(t);if(n&&(o.className=n),i){var a=e.createTextNode(i);o.appendChild(a)}return o},r=function(e,t,n){var i=a(o.DIV,"qz-box qz-box-inline qz-box-muted qz-text-center");if(e){var r=a(o.DIV,"qz-help-text",e);i.appendChild(r)}var l=a(o.STRONG,"qz-box-content "+n,t);return i.appendChild(l),i};return{style:function(){return a(o.STYLE,"qz-style",i.CSS)},header:function(){return a(o.P,"qz-box-head")},headerLaborTime:function(e){return r(n("labor"),e,"qz-text-green")},headerBalanceTime:function(e){return r(n("balance"),e,"qz-text-teal")},headerWeekPendingTime:function(e){return r(n("pending"),e,"qz-text-primary")},headerExtraTime:function(e){return r(n("extra"),e,"qz-text-green")},headerBeta:function(){var e=r("New","","fa fa-flask qz-text-golden");return e.className+=" qz-box-compact",e.onclick=function(){t.beta()},e},buildToggleForDayOff:function(e){return a(o.SPAN,"fa fa-toggle-"+e+" qz-toggle")},balanceTimePerDay:function(e){var t=a(o.DIV,"qz-help-text",n("balance")),i=a(o.STRONG,"qz-box-content qz-text-teal",e),r=a(o.DIV,"qz-box qz-box-muted");return r.appendChild(t),r.appendChild(i),r},laborTimePerDay:function(e){var t=a(o.DIV,"qz-help-text",n("labor")),i=a(o.STRONG,"qz-box-content qz-text-green",e),r=a(o.DIV,"qz-box qz-box-muted");return r.appendChild(t),r.appendChild(i),r},laborTimePerShift:function(e,t){var i=a(o.DIV,"qz-box qz-box-muted"),r=a(o.STRONG,"qz-box-content",e);if(!t){var l=a(o.DIV,"qz-help-text",n("working"));i.appendChild(l),r.classList.add("qz-text-golden")}return i.appendChild(r),i},todayTimeToLeave:function(e,t){var i=n(t?"exit+":"exit"),r=a(o.DIV,"qz-help-text",i),l=a(o.STRONG,"qz-box-content qz-text-primary",e),s=a(o.DIV,"qz-box qz-box-muted");return s.appendChild(r),s.appendChild(l),s}}}();t.module.snippet=a}(document,Queiroz),function(e,t){var n=function(){var t={HEAD:"head",BODY:"body",COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao",FOOTER:"footer .LabelEmpresa",TOOGLE:".HfIsFolga",QUEIROZ:"*[class*=qz-]"},n=function(e){setTimeout(e,25)},i=function(t,n){return(n||e).querySelector(t)},o=function(t,n){return(n||e).querySelectorAll(t)},a=function(t,o,a){n(function(){var n=i(t);if("string"==typeof o){var r=e.createElement("DIV");r.innerHTML=o,o=r.firstChild}n.appendChild(o),a&&a()})};return{collectData:function(){var e={},n=[];return o(t.COLUMN_DAY).forEach(function(e){var a={date:i(t.DATE,e).value,periods:[]};o(t.CHECKPOINT,e).forEach(function(e){var t=e.classList.value,n=e.textContent,i=a.periods;if(/TimeIN/.test(t))i.push({in:n,out:!1});else if(/TimeOUT/.test(t)){var o=i.last();o&&0==o.out?o.out=n:i.push({in:!1,out:n})}}),n.push(a)}),e.days=n,e},isLoaded:function(){return i(t.CHECKPOINT)},getAllColumnDay:function(){return o(t.COLUMN_DAY)},getAllCheckpoint:function(e){return o(t.CHECKPOINT,e)},getDateFromTargetAsString:function(e){return i(t.DATE,e).value},getAllTimeIn:function(e){return o(t.TIME_IN,e)},getAllQueirozElements:function(){return o(t.QUEIROZ)},appendToHead:function(e){a(t.HEAD,e)},appendToBody:function(e,n){a(t.BODY,e,n)},appendToHeader:function(e){a(t.HEADER,e)},appendToFooter:function(e){i(t.FOOTER).textContent+=" | "+e},appendToggle:function(e,n){i(t.TOOGLE,e).parentElement.appendChild(n)}}}();t.module.view=n}(document,Queiroz),function(e){var t=e.settings,n=function(){var e=6e4*t.WEEKLY_GOAL_MINUTES,n=6e4*t.DAILY_GOAL_MINUTES,i=(t.MAX_CONSECUTIVE_MINUTES,function(e,t){return e instanceof Date&&t instanceof Date?t.getMillis()-e.getMillis():t-e}),o=function(e){var t=new Date;return e.getDayOfMonth()===t.getDayOfMonth()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},a=function(e){var t=e.split(" "),n=t[0].split("_"),i=t[1].split(":");return new Date(n[2],n[1]-1,n[0],i[0],i[1])},r=function(e){var t=parseInt(e/36e5),n=parseInt(e/6e4%60);return t.format(2)+":"+n.format(2)},l=function(e){return 0==e?"00:00":e>0?"+"+r(e):e<0?"-"+r(-1*e):void 0},s=function(e){e.days.forEach(function(e){e.periods.forEach(function(e){e.shift=!1,e.in&&e.out&&(e.shift=i(e.in,e.out))})})},u=function(e){e.totalLabor=0,e.days.forEach(function(t){t.labor=0,t.periods.forEach(function(e){e.shift&&(t.labor+=e.shift)}),e.totalLabor+=t.labor})},d=function(t){var i=new Date;t.totalPreviousBalance=0,t.days.forEach(function(e){e.balance=0-n+e.labor,e.date.getDayOfMonth()<i.getDayOfMonth()&&(t.totalPreviousBalance+=e.balance)}),t.totalBalance=0-e+t.totalLabor},m=function(e){e.days.forEach(function(e){var t=e.periods;if(o(e.date)&&t.length){var a=t.last();if(0==a.out&&e.labor<=n){var r=i(e.labor,n);a.leave=new Date(a.in.getMillis()+r),a.balancedLeave=a.leave+e.balance}}})};return{transformToDate:function(e){e.days.forEach(function(e){e.periods.forEach(function(t){t.in&&(t.in=a(e.date+" "+t.in)),t.out&&(t.out=a(e.date+" "+t.out))}),e.date=a(e.date+" 12:34")})},computeTimes:function(e){s(e),u(e),m(e),d(e)},transformToHuman:function(e){e.totalLabor=r(e.totalLabor),e.totalPreviousBalance=l(e.totalPreviousBalance),e.totalBalance=l(e.totalBalance),e.days.forEach(function(e){e.labor=r(e.labor),e.balance=l(e.balance),e.periods.forEach(function(e){e.in&&(e.in=e.in.getTimeAsString()),e.out&&(e.out=e.out.getTimeAsString()),e.shift&&(e.shift=r(e.shift))})})},hourToMillis:function(e){return 36e5*e},zero:"00:00",fake:"12:34",diff:i,toDate:a,isToday:o,minuteToMillis:function(e){return 6e4*e},millisToHuman:r,millisToHumanWithSign:l}}();e.module.time=n}(Queiroz),function(e){Array.prototype.last=function(){return this[this.length-1]},Array.prototype.contains=function(e){return this.indexOf(e)>-1},Storage.prototype.hasItem=function(e){return this.getItem(e)||!1},Number.prototype.format=function(e){for(var t=""+this;t.length<e;)t="0"+t;return t},Date.prototype.getTimeAsString=function(){return this.getHours().format(2)+":"+this.getMinutes().format(2)},Date.prototype.getDayOfMonth=function(){return this.getDate()},Date.prototype.getMillis=function(){return this.getTime()},Element.prototype.remove=function(){this.parentElement.removeChild(this)},String.prototype.contains=function(e){return this.search(e)>-1};var t=function(){return{textFormat:function(e,t){for(var n=0;n<t.length;n++){var i=new RegExp("\\{"+n+"\\}","g");e=e.replace(i,t[n])}return e}}}();e.module.util=t}(Queiroz),function(e,t){var n=function(){var t="dayoff",n=[],i=function(e){return e.getDate().format(2)+"/"+(e.getMonth()+1).format(2)},o=function(e){return n.contains(i(e))},a=function(a){o(a)||(n.push(i(a)),e.setItem(t,JSON.stringify(n)))},r=function(a){if(0!=o(a)){var r=n.indexOf(i(a));n.splice(r,1),e.setItem(t,JSON.stringify(n))}};return e.hasItem(t)&&(n=JSON.parse(e.getItem(t))),{is:o,add:a,remove:r}}();t.module.dayoff=n}(localStorage,Queiroz),function(e){var t=e.settings,n=e.module,i=(n.kairos,n.view),o=n.time,a=(n.util,n.snippet),r=n.dayoff,l=function(){return o.minuteToMillis(t.WEEKLY_GOAL_MINUTES)-d.dayOffCount*u()},s=function(){return o.minuteToMillis(t.MAX_CONSECUTIVE_MINUTES)},u=function(){return o.minuteToMillis(t.DAILY_GOAL_MINUTES)},d={dayOffCount:0,week:{laborTime:{millis:0,human:"",html:""},balanceTime:{millis:0,human:"",html:""},pendingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computePendingTimeInMillis:function(){return l()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-l()},_buildHumanBalanceTime:function(){return o.millisToHumanWithSign(this.balanceTime.millis)},buildTime:function(){this.pendingTime.millis=this._computePendingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=o.millisToHuman(this.laborTime.millis),this.balanceTime.human=this._buildHumanBalanceTime(),this.pendingTime.human=o.millisToHuman(this.pendingTime.millis>0?this.pendingTime.millis:0),this.extraTime.human=o.millisToHuman(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=a.headerLaborTime(this.laborTime.human),this.balanceTime.html=a.headerBalanceTime(this.balanceTime.human),this.pendingTime.html=a.headerWeekPendingTime(this.pendingTime.human),this.extraTime.html=a.headerExtraTime(this.extraTime.human)}},today:{laborTime:{millis:0}}},m=function(e){return i.getDateFromTargetAsString(e)},c=function(){return d.week.pendingTime.millis>=0?d.week.pendingTime.html:d.week.extraTime.html},f=function(e){var t=a.header();return e.forEach(function(e){e&&t.appendChild(e)}),t},p=function(){d.week.buildTime(),d.week.buildHumanTime(),d.week.buildHtmlTime();var e=[d.week.laborTime.html,d.week.balanceTime.html,c(),a.headerBeta()],t=f(e);i.appendToHeader(t)},h=function(e,t,n){t<0&&(t=0);var i=o.millisToHuman(t),r=a.laborTimePerShift(i,n);document.createElement("div").appendChild(r);var l=e.parentNode;l.parentNode.insertBefore(r,l.nextSibling)},b=function(e,t){var n=o.millisToHuman(t);e.appendChild(a.laborTimePerDay(n))},g=function(e,t){var n=o.isToday(o.toDate(m(e)+" "+o.fake)),i=u(),r=0,l=o.zero;t<i?(r=i-t,l="-"+o.millisToHuman(r),0==n&&(d.week.balanceTime.millis-=r)):t>i&&(r=t-i,l="+"+o.millisToHuman(r),0==n&&(d.week.balanceTime.millis+=r)),0==n&&e.appendChild(a.balanceTimePerDay(l))},T=function(e,t){if(t&&d.week.balanceTime.millis){var n=u()-d.today.laborTime.millis-d.week.balanceTime.millis,i=t+(n<0?0:n),o=new Date(i).getTimeAsString(),r=a.todayTimeToLeave(o,!0),l=e.parentNode;l.parentNode.insertBefore(r,l.nextSibling)}},v=function(e,t){if(t&&d.today.laborTime.millis<u()){T(e,t);var n=t+(u()-d.today.laborTime.millis),i=new Date(n).getTimeAsString(),o=a.todayTimeToLeave(i,!1),r=e.parentNode;r.parentNode.insertBefore(o,r.nextSibling)}},x=function(t){var n=a.buildToggleForDayOff(r.is(t)?"off":"on");return n.onclick=function(){var n=t;r.is(n)?(r.remove(n),d.dayOffCount--):(r.add(n),d.dayOffCount++),e.reload()},n},y=function(e){var n=o.toDate(m(e)+" "+o.fake);if(t.WORK_DAYS.contains(n.getDay())){var a=x(n);if(i.appendToggle(e,a),r.is(n))return void d.dayOffCount++}var l=i.getAllCheckpoint(e);if(l.length){var u=0;i.getAllTimeIn(e).forEach(function(t,n){var i=t.textContent;if(0!=i){var a=o.toDate(m(e)+" "+i),r=l[2*n+1];if(r&&0==r.parentElement.classList.contains("LastSlot")){var c=r.textContent,f=o.toDate(m(e)+" "+c),p=o.diff(a,f);u+=p,h(r,p,!0),o.isToday(a)&&(d.today.laborTime.millis+=p)}else{v(t,a.getMillis());var b=o.diff(a,new Date);b<s()&&h(t,u+b,!1)}}}),u>0&&(d.week.laborTime.millis+=u,b(e,u)),g(e,u)}},z=function(){var e=[],n=!1;return i.getAllColumnDay().forEach(function(i){var a=m(i)+" "+o.fake,r=o.toDate(a);n||(n=r.getDay()===t.INITIAL_WEEKDAY)?e.push(i):i.remove()}),e},E=function(){i.appendToHead(a.style()),z().forEach(y),p()},D=function(){var e=setInterval(function(){i.isLoaded()&&(clearInterval(e),E())},t.USERSCRIPT_DELAY_MILLIS)};e.bless=function(e){return i.isLoaded()?E():D(),i.appendToFooter(this.description),this.description},e.beta=function(){var e=document.querySelector(".qz-modal");if(e)return e.classList.remove("js-hide"),void e.classList.add("js-show");i.appendToBody('<div class="qz-modal"><div class="qz-modal-dialog"><div class="qz-modal-content"><div class="qz-modal-header">Queiroz.js 3.0 is coming <button class="qz-modal-close"><span class="fa fa-times"></span></button></div><div class="qz-modal-body qz-text-center"><h1>Coming soon!</h1></div><div class="qz-modal-footer"><small>Queiroz.js 3.0.4</small></div></div></div></div>',function(){document.querySelector(".qz-modal-close").onclick=function(){e||(e=document.querySelector(".qz-modal")),e.classList.remove("js-show"),e.classList.add("js-hide")}})},e.reload=function(){i.getAllQueirozElements().forEach(function(e){e.remove()}),d.dayOffCount=0,d.week.laborTime.millis=0,d.week.balanceTime.millis=0,d.week.pendingTime.millis=0,d.week.extraTime.millis=0,d.today.laborTime.millis=0,e.bless()}}(Queiroz),Queiroz.bless();