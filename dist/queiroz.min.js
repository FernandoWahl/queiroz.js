
/*!
 * Queiroz.js 3.0.9
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(e){var t={name:"Queiroz.js",version:"3.0.9",description:"Queiroz.js 3.0.9",module:{},settings:{USERSCRIPT_DELAY_MILLIS:1e3,MAX_CONSECUTIVE_MINUTES:360,WEEKLY_GOAL_MINUTES:2640,DAILY_GOAL_MINUTES:528,WORK_DAYS:[1,2,3,4,5],INITIAL_WEEKDAY:1,GA_TRACKING_ID:"UA-105390656-1"}};e.Queiroz=t}(window),function(e,t){t("create",e.settings.GA_TRACKING_ID,"auto","qzTkr"),t("qzTkr.set",{appName:e.name,appVersion:e.version}),t("qzTkr.send","screenview",{screenName:document.querySelector(".PageTitle").textContent})}(Queiroz,ga),function(){Array.prototype.last=function(){return this[this.length-1]},Array.prototype.contains=function(e){return this.indexOf(e)>-1},Storage.prototype.hasItem=function(e){return this.getItem(e)||!1},Number.prototype.format=function(e){for(var t=""+this;t.length<e;)t="0"+t;return t},Date.prototype.getDateAsKairos=function(){return this.getDate().format(2)+"_"+(this.getMonth()+1).format(2)+"_"+this.getFullYear()},Date.prototype.getTimeAsString=function(){return this.getHours().format(2)+":"+this.getMinutes().format(2)},Date.prototype.getDayOfMonth=function(){return this.getDate()},Date.prototype.getMillis=function(){return this.getTime()},Element.prototype.remove=function(){this.parentElement.removeChild(this)},String.prototype.contains=function(e){return this.indexOf(e)>-1}}(),function(e){var t=function(e){return t._[e]};t._={pending:"Pendente",extra:"Extra",balance:"Saldo",labor:"Efetuado",shift:"Turno",working:"Trabalhando...",exit:"Saída (08:48)","exit+":"Saída + Saldo",config:"Config"},e.module.strings=t}(Queiroz),function(e){var t={CSS:"html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}#SemanaApontamentos{cursor:default!important}.ContentTable{margin-top:inherit}.FilledSlot,.LastSlot,.emptySlot{height:inherit;padding:5px}.FilledSlot span{margin:inherit!important}.qz-text-center{text-align:center}.qz-text-primary{color:brown}.qz-text-golden{color:#b8860b}.qz-text-green{color:green}.qz-text-teal{color:teal}.qz-box{padding:5px 10px;margin:5px 1px;border:#a9a9a9 1px solid;min-width:60px}.qz-box-compact{min-width:auto}.qz-box-inline{display:inline-block}.qz-box-head{float:right}.qz-box-muted{background-color:#d3d3d3}.qz-box .qz-box-content{vertical-align:middle}.qz-help-text{font-size:10px}.qz-toggle{margin-top:10px}.fa-toggle-on{color:green}.fa-toggle-off{color:grey}.js-show{display:block}.js-hide{display:none}.qz-modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1024;background-color:rgba(0,0,0,.5)}.qz-modal-dialog{position:relative;width:900px;margin:30px auto}.qz-modal-content{position:relative;background-color:#fff;background-clip:padding-box;border-radius:5px}.qz-modal-header{padding:10px;border-bottom:1px solid #d3d3d3;font-weight:700;font-size:16px}.qz-modal-close{float:right;cursor:pointer;background:0 0;border:0;padding:0;color:silver}.qz-modal-body{padding:10px}.qz-modal-footer{padding:10px;border-top:1px solid #d3d3d3;text-align:center}"};e.module.style=t}(Queiroz),function(e,t){var n=function(){var t="dayoff",n=[],o=function(e){return e.getDate().format(2)+"/"+(e.getMonth()+1).format(2)},i=function(e){return n.contains(o(e))},a=function(a){i(a)||(n.push(o(a)),e.setItem(t,JSON.stringify(n)))},r=function(a){if(0!=i(a)){var r=n.indexOf(o(a));n.splice(r,1),e.setItem(t,JSON.stringify(n))}};return e.hasItem(t)&&(n=JSON.parse(e.getItem(t))),{check:function(e){var t=[];e.days.forEach(function(e){0==i(e.date)&&t.push(e)}),e.days=t},is:i,add:a,remove:r}}();n.count=0,t.module.dayoff=n}(localStorage,Queiroz),function(e,t){var n=t.module.strings,o=t.module.style,i=function(){var i={DIV:"div",P:"p",SPAN:"span",STYLE:"style",STRONG:"strong",BUTTON:"button",SMALL:"small",TABLE:"table",THEAD:"thead",TBODY:"tbody",TH:"th",TR:"tr",TD:"td"},a=function(t,n,o){var i=e.createElement(t);if(n&&(i.className=n),o){var a=e.createTextNode(o);i.appendChild(a)}return i},r=function(e){var t=a(i.DIV,"qz-box qz-box-muted qz-text-center"),o=a(i.DIV,"qz-help-text",n(e.helpText)),r=a(i.STRONG,"qz-box-content "+e.contentClass,e.humanTime);return t.appendChild(o),t.appendChild(r),e.inlineText&&(t.className+=" qz-box-inline"),t};return{style:function(){return a(i.STYLE,"qz-style",o.CSS)},header:function(){return a(i.P,"qz-box-head")},buildToggleForDayOff:function(e){return a(i.SPAN,"fa fa-toggle-"+e+" qz-toggle")},headerBeta:function(){var e=r({helpText:"config",humanTime:"",contentClass:"fa fa-flask qz-text-golden",inlineText:!0});return e.className+=" qz-box-compact",e.onclick=function(){t.beta()},e},headerLaborTime:function(e){return r({helpText:"labor",humanTime:e,contentClass:"qz-text-green",inlineText:!0})},headerBalanceTime:function(e,t){return r({helpText:t?e.contains("+")?"extra":"pending":"balance",humanTime:e,contentClass:"qz-text-"+(t?e.contains("+")?"green":"primary":"teal"),inlineText:!0})},balanceTimePerDay:function(e){return r({helpText:"balance",humanTime:e,contentClass:"qz-text-teal"})},laborTimePerDay:function(e){return r({helpText:"labor",humanTime:e,contentClass:"qz-text-green"})},laborTimePerShift:function(e,t){return r({helpText:t?"shift":"working",humanTime:e,contentClass:t?"":"qz-text-golden"})},todayTimeToLeave:function(e,t){return r({helpText:"exit"+(t?"+":""),humanTime:e,contentClass:"qz-text-primary"})}}}();t.module.snippet=i}(document,Queiroz),function(e,t){var n=t.settings,o=t.module.snippet,i=function(){var t={HEAD:"head",BODY:"body",COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao",FOOTER:"footer .LabelEmpresa",TOOGLE:".HfIsFolga",QUEIROZ:"*[class*=qz-]"},a=function(e){setTimeout(e,25)},r=function(t,n){return(n||e).querySelector(t)},l=function(t,n){return(n||e).querySelectorAll(t)},s=function(t,n,o){a(function(){var i=r(t);if("string"==typeof n){var a=e.createElement("DIV");a.innerHTML=n,n=a.firstChild}i.appendChild(n),o&&o()})};return{read:function(){var e={},n=[];return l(t.COLUMN_DAY).forEach(function(e){var o={date:r(t.DATE,e).value,periods:[]};l(t.CHECKPOINT,e).forEach(function(e){var t=e.classList.value,n=e.textContent,i=o.periods;if(/TimeIN/.test(t))i.push({in:n,out:!1});else if(/TimeOUT/.test(t)){var a=i.last();a&&0==a.out?a.out=n:i.push({in:!1,out:n})}}),n.push(o)}),e.days=n,e},removeUnusedDays:function(e){var o=0,i=e.days;i.forEach(function(e,t){e.date.getDay()===n.INITIAL_WEEKDAY&&(o=t)}),e.days=i.slice(o),l(t.COLUMN_DAY).forEach(function(n){var o=!0;e.days.forEach(function(e){var i=r(t.DATE,n).value;e.date.getDateAsKairos()==i&&(o=!1)}),o&&n.remove()})},showResult:function(e){var n=l(t.COLUMN_DAY);e.days.forEach(function(e){n.forEach(function(n){var i=r(t.DATE,n).value;e.date.getDateAsKairos()==i&&(e.periods.forEach(function(e){0==e.out?(n.appendChild(o.laborTimePerShift(e.shift,!1)),n.appendChild(o.todayTimeToLeave(e.leave,!1)),n.appendChild(o.todayTimeToLeave(e.balancedLeave,!0))):n.appendChild(o.laborTimePerShift(e.shift,!0))}),e.periods.length&&(n.appendChild(o.laborTimePerDay(e.worked)),n.appendChild(o.balanceTimePerDay(e.balance))))})});var a=o.header();a.appendChild(o.headerLaborTime(e.worked)),a.appendChild(o.headerBalanceTime(e.dailyBalance,!1)),a.appendChild(o.headerBalanceTime(e.weeklyBalance,!0)),a.appendChild(o.headerBeta()),i.appendToHeader(a)},isLoaded:function(){return r(t.CHECKPOINT)},getAllColumnDay:function(){return l(t.COLUMN_DAY)},getAllCheckpoint:function(e){return l(t.CHECKPOINT,e)},getDateFromTargetAsString:function(e){return r(t.DATE,e).value},getAllTimeIn:function(e){return l(t.TIME_IN,e)},getAllQueirozElements:function(){return l(t.QUEIROZ)},appendToHead:function(e){s(t.HEAD,e)},appendToBody:function(e,n){s(t.BODY,e,n)},appendToHeader:function(e){s(t.HEADER,e)},appendToFooter:function(e){var n=r(t.FOOTER).textContent;n&&0==n.contains(e)&&(r(t.FOOTER).textContent+=" | "+e)},appendToggle:function(e,n){r(t.TOOGLE,e).parentElement.appendChild(n)}}}();t.module.view=i}(document,Queiroz),function(e){var t=e.settings,n=e.module.dayoff,o=function(){var e=6e4*t.DAILY_GOAL_MINUTES,o=(t.MAX_CONSECUTIVE_MINUTES,function(){return 6e4*t.WEEKLY_GOAL_MINUTES-n.count*e}),i=function(e,t){return e instanceof Date&&t instanceof Date?t.getMillis()-e.getMillis():t-e},a=function(e){var t=new Date;return e.getDayOfMonth()===t.getDayOfMonth()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},r=function(e){var t=e.split(" "),n=t[0].split("_"),o=t[1].split(":");return new Date(n[2],n[1]-1,n[0],o[0],o[1])},l=function(e){var t=parseInt(e/36e5),n=parseInt(e/6e4%60);return t.format(2)+":"+n.format(2)},s=function(e){return 0==e?"00:00":e>0?"+"+l(e):e<0?"-"+l(-1*e):void 0},d=function(e){e.days.forEach(function(e){e.periods.forEach(function(e){e.shift=!1,e.in&&e.out?e.shift=i(e.in,e.out):e.in&&(e.shift=i(e.in,new Date))})})},c=function(e){e.worked=0,e.days.forEach(function(t){t.worked=0,t.periods.forEach(function(e){e.in&&e.out&&(t.worked+=e.shift)}),e.worked+=t.worked})},u=function(t){var n=new Date;t.dailyBalance=0,t.days.forEach(function(o){o.balance=0,o.periods.length&&(o.balance=0-e+o.worked,o.date.getDayOfMonth()<n.getDayOfMonth()&&(t.dailyBalance+=o.balance))}),t.weeklyBalance=0-o()+t.worked},f=function(t){t.days.forEach(function(n){var o=n.periods;if(a(n.date)&&o.length){var r=o.last();if(0==r.out&&n.worked<e){var l=i(n.worked,e);r.leave=new Date(r.in.getMillis()+l),r.balancedLeave=new Date(r.leave.getMillis()-t.dailyBalance)}}})};return{parse:function(e){e.days.forEach(function(e){e.periods.forEach(function(t){t.in&&(t.in=r(e.date+" "+t.in)),t.out&&(t.out=r(e.date+" "+t.out))}),e.date=r(e.date+" 12:34")})},compute:function(e){d(e),c(e),u(e),f(e)},toHuman:function(e){e.days.forEach(function(e){e.periods.forEach(function(e){e.in&&(e.in=e.in.getTimeAsString()),e.out&&(e.out=e.out.getTimeAsString()),e.shift&&(e.shift=l(e.shift)),e.leave&&(e.leave=e.leave.getTimeAsString()),e.balancedLeave&&(e.balancedLeave=e.balancedLeave.getTimeAsString())}),e.worked=l(e.worked),e.balance=s(e.balance)}),e.worked=l(e.worked),e.dailyBalance=s(e.dailyBalance),e.weeklyBalance=s(e.weeklyBalance)},zero:"00:00",fake:"12:34",diff:i,toDate:r,isToday:a,minuteToMillis:function(e){return 6e4*e},millisToHuman:l,millisToHumanWithSign:s}}();e.module.time=o}(Queiroz),function(e){var t=e.settings,n=e.module,o=n.snippet,i=n.view,a=n.dayoff,r=n.time,l=function(t){var n=o.buildToggleForDayOff(a.is(t)?"off":"on");return n.onclick=function(){var n=t;a.is(n)?(a.remove(n),a.count--):(a.add(n),a.count++),e.reload()},n},s=function(){i.getAllColumnDay().forEach(function(e){var n=r.toDate(i.getDateFromTargetAsString(e)+" "+r.fake);if(t.WORK_DAYS.contains(n.getDay())){var o=l(n);if(i.appendToggle(e,o),a.is(n))return void a.count++}})},d=function(){i.appendToHead(o.style()),s();var e=i.read();r.parse(e),i.removeUnusedDays(e),a.check(e),r.compute(e),r.toHuman(e),i.showResult(e)},c=function(){var e=setInterval(function(){i.isLoaded()&&(clearInterval(e),d())},t.USERSCRIPT_DELAY_MILLIS)};e.bless=function(e){return i.isLoaded()?d():c(),i.appendToFooter(this.description),this.description},e.beta=function(){var e=document.querySelector(".qz-modal");if(e)return e.classList.remove("js-hide"),void e.classList.add("js-show");i.appendToBody('<div class="qz-modal"><div class="qz-modal-dialog"><div class="qz-modal-content"><div class="qz-modal-header">Queiroz.js 3.0 is coming <button class="qz-modal-close"><span class="fa fa-times"></span></button></div><div class="qz-modal-body qz-text-center"><h1>Coming soon!</h1></div><div class="qz-modal-footer"><small>Queiroz.js 3.0.9</small></div></div></div></div>',function(){document.querySelector(".qz-modal-close").onclick=function(){e||(e=document.querySelector(".qz-modal")),e.classList.remove("js-show"),e.classList.add("js-hide")}})},e.reload=function(){i.getAllQueirozElements().forEach(function(e){e.remove()}),a.count=0,e.bless()}}(Queiroz),Queiroz.bless();