
/*!
 * Queiroz.js 2.7.1
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(i){var t=function(){return{append:function(i,t){var e=this;e.asyncReflow(function(){var n=e.get(i),s=document.createElement("div");s.innerHTML=t,n.appendChild(s)})},asyncReflow:function(i){setTimeout(i,25)},get:function(i,t){return(t||document).querySelector(i)},getAll:function(i,t){return(t||document).querySelectorAll(i)}}}();i.view=t}(window),function(i){var t=function(){var i={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},t=function(i){return i<10?"0"+i:i},e=function(){return{toMillis:function(i){return i*s.IN_HOUR}}}(),n=function(){return{toMillis:function(i){return i*s.IN_MINUTE}}}(),s=function(){return{IN_MINUTE:6e4,IN_HOUR:36e5,diff:function(i,t){return i instanceof Date&&t instanceof Date?t.getTime()-i.getTime():t-i},toHumanTime:function(i){var e=parseInt(i/36e5),n=parseInt(i/6e4%60);return t(e)+":"+t(n)}}}();return{Hour:e,Minute:n,Millis:s,Weekday:i,dateToHumanTime:function(i){return t(i.getHours())+":"+t(i.getMinutes())},isToday:function(i){var t=new Date;return i.getDate()===t.getDate()&&i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear()},toDate:function(i){var t=i.split(" "),e=t[0].split("_"),n=t[1].split(":");return new Date(e[2],e[1]-1,e[0],n[0],n[1])}}}();i.time=t}(window),function(i){var t=function(){return{textFormat:function(i,t){for(var e=0;e<t.length;e++){var n=new RegExp("\\{"+e+"\\}","g");i=i.replace(n,t[e])}return i}}}();i.util=t}(window),function(i,t,e,n){var s=function(){var i={INITIAL_WEEKDAY:e.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_CONSECUTIVE_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,MAX_MINUTES_PER_DAY:528,TAMPERMONKEY_DELAY_MILLIS:1e3},s={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao"},m={HEADER:'<p class="qz-box-head">{0}{1}{2}{3}{4}</p>',HEADER_LAST_WEEK_MODE_ON:'<span class="qz-box qz-box-muted"><strong class="qz-text-primary">SEMANA ANTERIOR</strong></span>',HEADER_LABOR_TIME:'<span class="qz-box qz-box-muted">Total: <strong class="qz-text-primary">{0}</strong></span>',HEADER_TODAY_MISSING_TIME:'<span class="qz-box qz-box-muted">Faltam/Hoje: <strong class="qz-text-primary">{0}</strong></span>',HEADER_WEEK_MISSING_TIME:'<span class="qz-box qz-box-muted">Faltam/Semana: <strong class="qz-text-primary">{0}</strong></span>',HEADER_EXTRA_TIME:'<span class="qz-box qz-box-muted">Extra: <strong class="qz-text-primary">{0}</strong></span>',HEADER_TIME_TO_LEAVE:'<span class="qz-box qz-box-muted">Sa√≠da/Fim: <strong class="qz-text-primary">{0}</strong></span>',LABOR_TIME_PER_DAY:'<div class="qz-box qz-box-muted"><strong class="qz-box-content qz-text-primary">{0}</strong></div>',LABOR_TIME_PER_SHIFT:'<div class="qz-box qz-box-muted"><strong class="qz-box-content">{0}</strong></div>',STYLE:"<style>strong{font-weight:bold;}.emptySlot,.FilledSlot,.LastSlot {height:inherit;padding:5px;}.qz-text-primary {color:brown;}.qz-box {padding:7px;margin:5px 1px;border:darkgrey 1px solid;}.qz-box-head {float:right;padding:10px 0;}.qz-box-muted {background-color:lightgray;}.qz-box .qz-box-content {margin-left:6px; vertical-align:middle;}</style>"},a=function(){return e.Hour.toMillis(i.MAX_HOURS_PER_WEEK)},o=function(){return e.Hour.toMillis(i.MAX_CONSECUTIVE_HOURS_PER_DAY)},l=function(){return e.Minute.toMillis(i.MAX_MINUTES_PER_DAY)},r={week:{laborTime:{millis:0,human:"",html:""},missingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:function(){return a()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-a()},buildTime:function(){this.missingTime.millis=this._computeMissingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=e.Millis.toHumanTime(this.laborTime.millis),this.missingTime.human=e.Millis.toHumanTime(this.missingTime.millis>0?this.missingTime.millis:0),this.extraTime.human=e.Millis.toHumanTime(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=n.textFormat(m.HEADER_LABOR_TIME,[this.laborTime.human]),this.missingTime.html=n.textFormat(m.HEADER_WEEK_MISSING_TIME,[this.missingTime.human]),this.extraTime.html=n.textFormat(m.HEADER_EXTRA_TIME,[this.extraTime.human])}},today:{laborTime:{millis:0},missingTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:function(){return l()-this.laborTime.millis},buildTime:function(){this.missingTime.millis=this._computeMissingTimeInMillis()},buildHumanTime:function(){this.missingTime.human=e.Millis.toHumanTime(this.missingTime.millis>0?this.missingTime.millis:0)},buildHtmlTime:function(){this.missingTime.html=n.textFormat(m.HEADER_TODAY_MISSING_TIME,[this.missingTime.human])}}},u="",E=function(i){return t.getAll(s.CHECKPOINT,i)},T=function(i){return t.get(s.DATE,i).value},_=function(){if(r.week.missingTime.millis<=0)return"";if(r.week.missingTime.millis>l())return"";var i="";if(u){var t=u.getTime()+r.week.missingTime.millis;if(!t||t<(new Date).getTime())return"";var s=e.dateToHumanTime(new Date(t));i=n.textFormat(m.HEADER_TIME_TO_LEAVE,[s])}return i},c=function(){r.week.buildHumanTime(),r.week.buildHtmlTime(),r.today.buildHumanTime(),r.today.buildHtmlTime();var e=i.LAST_WEEK_MODE?m.HEADER_LAST_WEEK_MODE_ON:"",a=_(r.week.missingTime.millis),o=[e,r.week.laborTime.html,r.today.missingTime.html,r.week.missingTime.millis>=0?r.week.missingTime.html:r.week.extraTime.html,a],l=n.textFormat(m.HEADER,o);t.append(s.HEADER,l)},A=function(){"ON"===i.LAST_WEEK_MODE&&(i.LAST_WEEK_MODE="DOING"),r.week.buildTime(),r.today.buildTime(),"DOING"!==i.LAST_WEEK_MODE&&c()},M=function(i,t){var s=e.Millis.toHumanTime(t),a=n.textFormat(m.LABOR_TIME_PER_SHIFT,[s]),o=document.createElement("div");o.innerHTML=a;var l=i.parentNode;return l.parentNode.insertBefore(o,l.nextSibling),o},d=function(i,t){var s=e.Millis.toHumanTime(t);i.innerHTML+=n.textFormat(m.LABOR_TIME_PER_DAY,[s])},g=function(n){var m=E(n);if(m.length){var a=0;t.getAll(s.TIME_IN,n).forEach(function(t,s){var l=t.textContent,E=e.toDate(T(n)+" "+l),_=m[2*s+1];if(_&&!_.parentElement.classList.contains("LastSlot")){var c=_.textContent,A=e.toDate(T(n)+" "+c),d=e.Millis.diff(E,A);a+=d,"DOING"!==i.LAST_WEEK_MODE&&M(_,d),e.isToday(E)&&(r.today.laborTime.millis+=d)}else{u=E;var g=e.Millis.diff(E,new Date);if(g<o()){var D=M(t,d=a+g),f=D.querySelector("strong");D.style.color="darkgoldenrod",f.textContent="~ "+f.textContent}}}),r.week.laborTime.millis+=a,d(n,a)}},D=function(){var n=[],m=!1;return t.getAll(s.COLUMN_DAY).forEach(function(t){var s=T(t)+" 12:34",a=e.toDate(s);0===r.week.laborTime.millis?(m||(m=a.getDay()===i.INITIAL_WEEKDAY))&&n.push(t):a.getDay()===i.INITIAL_WEEKDAY?i.LAST_WEEK_MODE="DONE":"DOING"===i.LAST_WEEK_MODE&&n.push(t)}),n},f=function(){t.append("head",m.STYLE),D().forEach(g),A(),"DOING"===i.LAST_WEEK_MODE&&(mudarSemana(1,!0),setTimeout(I,1e3))},I=function(){var e=setInterval(function(){t.get(s.CHECKPOINT)&&(clearInterval(e),f())},i.TAMPERMONKEY_DELAY_MILLIS)};return{bless:function(e){return i.LAST_WEEK_MODE=!!e&&"ON","ON"===i.LAST_WEEK_MODE?(mudarSemana(-1,!0),setTimeout(I,1e3)):t.get(s.CHECKPOINT)?f():I(),"Queiroz.js 2.7.1"},name:"Queiroz.js",version:"2.7.1"}}();i.Queiroz=s}(window,view,time,util),Queiroz.bless();