
/*!
 * Queiroz.js 2.7.0
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(i){var t=function(){return{append:function(i,t){var e=this;e.asyncReflow(function(){var n=e.get(i),m=document.createElement("div");m.innerHTML=t,n.appendChild(m)})},asyncReflow:function(i){setTimeout(i,25)},get:function(i,t){return(t||document).querySelector(i)},getAll:function(i,t){return(t||document).querySelectorAll(i)}}}();i.view=t}(window),function(i){var t=function(){var i={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},t=function(i){return i<10?"0"+i:i},e=function(){return{toMillis:function(i){return i*m.IN_HOUR}}}(),n=function(){return{toMillis:function(i){return i*m.IN_MINUTE}}}(),m=function(){return{IN_MINUTE:6e4,IN_HOUR:36e5,diff:function(i,t){return i instanceof Date&&t instanceof Date?t.getTime()-i.getTime():t-i},toHumanTime:function(i){var e=parseInt(i/36e5),n=parseInt(i/6e4%60);return t(e)+":"+t(n)}}}();return{Hour:e,Minute:n,Millis:m,Weekday:i,dateToHumanTime:function(i){return t(i.getHours())+":"+t(i.getMinutes())},isToday:function(i){var t=new Date;return i.getDate()===t.getDate()&&i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear()},toDate:function(i){var t=i.split(" "),e=t[0].split("_"),n=t[1].split(":");return new Date(e[2],e[1]-1,e[0],n[0],n[1])}}}();i.time=t}(window),function(i){var t=function(){return{textFormat:function(i,t){for(var e=0;e<t.length;e++){var n=new RegExp("\\{"+e+"\\}","g");i=i.replace(n,t[e])}return i}}}();i.util=t}(window),function(i,t,e,n){var m=function(){var i={INITIAL_WEEKDAY:e.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_CONSECUTIVE_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,MAX_MINUTES_PER_DAY:528,TAMPERMONKEY_DELAY_MILLIS:1e3},m={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao"},r={HEADER:'<p class="qz-box qz-box-head qz-box-muted">{0}{1}{2}{3}{4}</p>',HEADER_LAST_WEEK_MODE_ON:'<strong class="qz-text-primary">SEMANA ANTERIOR</strong>  |  ',HEADER_LABOR_TIME:'Total: <strong class="qz-text-primary">{0}</strong>',HEADER_TODAY_MISSING_TIME:'  |  Faltam/Hoje: <strong class="qz-text-primary">{0}</strong>',HEADER_WEEK_MISSING_TIME:'  |  Faltam/Semana: <strong class="qz-text-primary">{0}</strong>',HEADER_EXTRA_TIME:'  |  Extra: <strong class="qz-text-primary">{0}</strong>',HEADER_TIME_TO_LEAVE:'  |  Sa√≠da/Fim: <strong class="qz-text-primary">{0}</strong>',LABOR_TIME_PER_DAY:'<div class="qz-box qz-box-muted"><strong class="qz-box-content qz-text-primary">{0}</strong></div>',LABOR_TIME_PER_SHIFT:'<div class="qz-box qz-box-muted"><strong class="qz-box-content">{0}</strong></div>',STYLE:"<style>strong{font-weight:bold;}.ContentTable {margin-top:inherit;}.emptySlot,.FilledSlot,.LastSlot {height:inherit;padding:5px;}.qz-text-primary {color:brown;}.qz-box {padding:7px;margin:5px 1px;}.qz-box-head {float:right;padding:10px;}.qz-box-muted {background-color:lightgray;}.qz-box .qz-box-content {margin-left:6px; vertical-align:middle;}</style>"},l=function(){return e.Hour.toMillis(i.MAX_HOURS_PER_WEEK)},o=function(){return e.Hour.toMillis(i.MAX_CONSECUTIVE_HOURS_PER_DAY)},s=function(){return e.Minute.toMillis(i.MAX_MINUTES_PER_DAY)},a={week:{laborTime:{millis:0,human:"",html:""},missingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:function(){return l()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-l()},buildTime:function(){this.missingTime.millis=this._computeMissingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=e.Millis.toHumanTime(this.laborTime.millis),this.missingTime.human=e.Millis.toHumanTime(this.missingTime.millis>0?this.missingTime.millis:0),this.extraTime.human=e.Millis.toHumanTime(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=n.textFormat(r.HEADER_LABOR_TIME,[this.laborTime.human]),this.missingTime.html=n.textFormat(r.HEADER_WEEK_MISSING_TIME,[this.missingTime.human]),this.extraTime.html=n.textFormat(r.HEADER_EXTRA_TIME,[this.extraTime.human])}},today:{laborTime:{millis:0},missingTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:function(){return s()-this.laborTime.millis},buildTime:function(){this.missingTime.millis=this._computeMissingTimeInMillis()},buildHumanTime:function(){this.missingTime.human=e.Millis.toHumanTime(this.missingTime.millis>0?this.missingTime.millis:0)},buildHtmlTime:function(){this.missingTime.html=n.textFormat(r.HEADER_TODAY_MISSING_TIME,[this.missingTime.human])}}},u="",E=function(i){return t.getAll(m.CHECKPOINT,i)},T=function(i){return t.get(m.DATE,i).value},_=function(){if(a.week.missingTime.millis<=0)return"";if(a.week.missingTime.millis>s())return"";var i="";if(u){var t=u.getTime()+a.week.missingTime.millis;if(!t||t<(new Date).getTime())return"";var m=e.dateToHumanTime(new Date(t));i=n.textFormat(r.HEADER_TIME_TO_LEAVE,[m])}return i},c=function(){a.week.buildHumanTime(),a.week.buildHtmlTime(),a.today.buildHumanTime(),a.today.buildHtmlTime();var e=i.LAST_WEEK_MODE?r.HEADER_LAST_WEEK_MODE_ON:"",l=_(a.week.missingTime.millis),o=[e,a.week.laborTime.html,a.today.missingTime.html,a.week.missingTime.millis>=0?a.week.missingTime.html:a.week.extraTime.html,l],s=n.textFormat(r.HEADER,o);t.append(m.HEADER,s)},A=function(){"ON"===i.LAST_WEEK_MODE&&(i.LAST_WEEK_MODE="DOING"),a.week.buildTime(),a.today.buildTime(),"DOING"!==i.LAST_WEEK_MODE&&c()},M=function(i,t){var m=e.Millis.toHumanTime(t),l=n.textFormat(r.LABOR_TIME_PER_SHIFT,[m]),o=document.createElement("div");o.innerHTML=l;var s=i.parentNode;return s.parentNode.insertBefore(o,s.nextSibling),o},g=function(i,t){var m=e.Millis.toHumanTime(t);i.innerHTML+=n.textFormat(r.LABOR_TIME_PER_DAY,[m])},D=function(n){var r=E(n);if(r.length){var l=0;t.getAll(m.TIME_IN,n).forEach(function(t,m){var s=t.textContent,E=e.toDate(T(n)+" "+s),_=r[2*m+1];if(_&&!_.parentElement.classList.contains("LastSlot")){var c=_.textContent,A=e.toDate(T(n)+" "+c),g=e.Millis.diff(E,A);l+=g,"DOING"!==i.LAST_WEEK_MODE&&M(_,g),e.isToday(E)&&(a.today.laborTime.millis+=g)}else{u=E;var D=e.Millis.diff(E,new Date);if(D<o()){var d=M(t,g=l+D),f=d.querySelector("strong");d.style.color="darkgoldenrod",f.textContent="~ "+f.textContent}}}),a.week.laborTime.millis+=l,g(n,l)}},d=function(){var n=[],r=!1;return t.getAll(m.COLUMN_DAY).forEach(function(t){var m=T(t)+" 12:34",l=e.toDate(m);0===a.week.laborTime.millis?(r||(r=l.getDay()===i.INITIAL_WEEKDAY))&&n.push(t):l.getDay()===i.INITIAL_WEEKDAY?i.LAST_WEEK_MODE="DONE":"DOING"===i.LAST_WEEK_MODE&&n.push(t)}),n},f=function(){t.append("head",r.STYLE),d().forEach(D),A(),"DOING"===i.LAST_WEEK_MODE&&(mudarSemana(1,!0),setTimeout(h,1e3))},h=function(){var e=setInterval(function(){t.get(m.CHECKPOINT)&&(clearInterval(e),f())},i.TAMPERMONKEY_DELAY_MILLIS)};return{bless:function(e){return i.LAST_WEEK_MODE=!!e&&"ON","ON"===i.LAST_WEEK_MODE?(mudarSemana(-1,!0),setTimeout(h,1e3)):t.get(m.CHECKPOINT)?f():h(),"Queiroz.js 2.7.0"},name:"Queiroz.js",version:"2.7.0"}}();i.Queiroz=m}(window,view,time,util),Queiroz.bless();