
/*!
 * Queiroz.js 2.6.7
 * JavaScript Extension for Dimep Kairos
 */

!function(t){var n=function(){return{append:function(t,n){var e=this;e.asyncReflow(function(){var r=e.get(t),i=document.createElement("div");i.innerHTML=n,r.appendChild(i)})},asyncReflow:function(t){setTimeout(t,25)},get:function(t,n){return(n||document).querySelector(t)},getAll:function(t,n){return(n||document).querySelectorAll(t)}}}();t.view=n}(window),function(t){var n=function(){var t={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},n=function(t){return t<10?"0"+t:t},e=function(){return{toMillis:function(t){return t*i.IN_HOUR}}}(),r=function(){return{toMillis:function(t){return t*i.IN_MINUTE}}}(),i=function(){return{IN_MINUTE:6e4,IN_HOUR:36e5,diff:function(t,n){return t instanceof Date&&n instanceof Date?n.getTime()-t.getTime():n-t},toHumanTime:function(t){var e=parseInt(t/36e5),r=parseInt(t/6e4%60);return n(e)+":"+n(r)}}}();return{Hour:e,Minute:r,Millis:i,Weekday:t,toDate:function(t){var n=t.split(" "),e=n[0].split("_"),r=n[1].split(":");return new Date(e[2],e[1]-1,e[0],r[0],r[1])},dateToHumanTime:function(t){return n(t.getHours())+":"+n(t.getMinutes())}}}();t.time=n}(window),function(t){var n=function(){return{textFormat:function(t,n){for(var e=0;e<n.length;e++){var r=new RegExp("\\{"+e+"\\}","g");t=t.replace(r,n[e])}return t}}}();t.util=n}(window),function(t,n,e,r){var i=function(){var t={INITIAL_WEEKDAY:e.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,NORMAL_MINUTES_PER_DAY:528,TAMPERMONKEY_DELAY_MILLIS:1e3},i={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao"},o={HEADER:'<p class="floatRight" style="padding: 10px; background-color: lightgray;">{0}{1}{2}{3}</p>',HEADER_LAST_WEEK_MODE_ON:'<span class="bold" style="color: green;">SEMANA ANTERIOR</span>  |  ',HEADER_LABOR_TIME:'Total: <span class="bold" style="color: brown;">{0}</span>',HEADER_MISSING_TIME:'  |  Faltam: <span class="bold" style="color: brown;">{0}</span>',HEADER_EXTRA_TIME:'  |  Extra: <span class="bold" style="color: brown;">{0}</span>',HEADER_TIME_TO_LEAVE:'  |  Sa√≠da/Fim: <span class="bold" style="color: brown;">{0}</span>',LABOR_TIME_PER_DAY:'<div class="FilledSlot" style="background-color: lightgray; padding-top: 5px; margin-bottom: 10px;"><span class="bold" style="margin-left: 6px; color: brown; vertical-align: middle;">{0}</span></div>',LABOR_TIME_PER_SHIFT:'<div class="FilledSlot" style="background-color: lightgray; padding-top: 5px; margin-bottom: 10px;"><span class="bold" style="margin-left: 6px; vertical-align: middle;">{0}</span></div>'},a=0,E="",l=function(){return t.MAX_HOURS_PER_WEEK*e.Millis.IN_HOUR},u=function(){return l()-a},_=function(){return a-l()},s=function(t){return n.getAll(i.CHECKPOINT,t)},c=function(t){return n.get(i.DATE,t).value},A=function(){return e.Hour.toMillis(t.MAX_HOURS_PER_DAY)},T=function(){return e.Minute.toMillis(t.NORMAL_MINUTES_PER_DAY)},D=function(t){if(t<=0)return"";if(t>T())return"";var n="";if(E){var i=E.getTime()+t;if(!i||i<(new Date).getTime())return"";var a=e.dateToHumanTime(new Date(i));n=r.textFormat(o.HEADER_TIME_TO_LEAVE,[a])}return n},f=function(e,a,E,l){var u=t.LAST_WEEK_MODE?o.HEADER_LAST_WEEK_MODE_ON:"",_=r.textFormat(o.HEADER_LABOR_TIME,[a]),s=r.textFormat(o.HEADER_MISSING_TIME,[E]),c=r.textFormat(o.HEADER_EXTRA_TIME,[l]),A=D(e),T=[u,_,e>=0?s:c,A],f=r.textFormat(o.HEADER,T);n.append(i.HEADER,f)},M=function(){"ON"===t.LAST_WEEK_MODE&&(t.LAST_WEEK_MODE="DOING");var n=u(),r=_(),i=e.Millis.toHumanTime(a),o=e.Millis.toHumanTime(n>0?n:0),E=e.Millis.toHumanTime(r>0?r:0);"DOING"!==t.LAST_WEEK_MODE&&f(n,i,o,E)},I=function(t,n){var i=e.Millis.toHumanTime(n),a=r.textFormat(o.LABOR_TIME_PER_SHIFT,[i]),E=document.createElement("div");E.innerHTML=a;var l=t.parentNode;return l.parentNode.insertBefore(E,l.nextSibling),E},d=function(t,n){var i=e.Millis.toHumanTime(n);t.innerHTML+=r.textFormat(o.LABOR_TIME_PER_DAY,[i])},m=function(r){var o=s(r);if(o.length){var l=0;n.getAll(i.TIME_IN,r).forEach(function(n,i){var a=n.textContent,u=e.toDate(c(r)+" "+a),_=o[2*i+1];if(_&&!_.parentElement.classList.contains("LastSlot")){var s=_.textContent,T=e.toDate(c(r)+" "+s),D=e.Millis.diff(u,T);l+=D,"DOING"!==t.LAST_WEEK_MODE&&I(_,D)}else{E=u;var f=e.Millis.diff(u,new Date);if(f<A()){var M=I(n,D=l+f),d=M.querySelector("span");M.style.color="darkgoldenrod",d.textContent="~ "+d.textContent}}}),d(r,l),a+=l}},O=function(){var r=[],o=!1;return n.getAll(i.COLUMN_DAY).forEach(function(n){var i=c(n)+" 12:34",E=e.toDate(i);0===a?(o||(o=E.getDay()===t.INITIAL_WEEKDAY))&&r.push(n):E.getDay()===t.INITIAL_WEEKDAY?t.LAST_WEEK_MODE="DONE":"DOING"===t.LAST_WEEK_MODE&&r.push(n)}),r},R=function(){O().forEach(m),M(),"DOING"===t.LAST_WEEK_MODE&&(mudarSemana(1,!0),setTimeout(p,1e3))},p=function(){var e=setInterval(function(){n.get(i.CHECKPOINT)&&(clearInterval(e),R())},t.TAMPERMONKEY_DELAY_MILLIS)};return{bless:function(e){return t.LAST_WEEK_MODE=!!e&&"ON","ON"===t.LAST_WEEK_MODE?(mudarSemana(-1,!0),setTimeout(p,1e3)):n.get(i.CHECKPOINT)?R():p(),"Queiroz.js 2.6.7"},name:"Queiroz.js",version:"2.6.7"}}();t.Queiroz=i}(window,view,time,util),Queiroz.bless();