
/*!
 * Queiroz.js 2.8.4
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(e){var i={name:"Queiroz.js",version:"2.8.4",description:"Queiroz.js 2.8.4",pl:{}};e.Queiroz=i}(window),function(e,i){var t=function(){return{backWeek:function(){e.mudarSemana(-1,!0)},nextWeek:function(){e.mudarSemana(1,!0)}}}();i.pl.kairos=t}(window,Queiroz),function(e){var i={DIV:"div",P:"p",SPAN:"span",STRONG:"strong"},t=function(){var e=function(e,i,t){var n=document.createElement(e);if(i&&(n.className=i),t){var a=document.createTextNode(t);n.appendChild(a)}return n},t=function(t,n,a){var r=e(i.SPAN,"qz-box qz-box-muted",t),o=e(i.STRONG,a,n);return r.appendChild(o),r};return{STYLE:"<style>strong{font-weight:700}#SemanaApontamentos{cursor:default!important}.ContentTable{margin-top:inherit}.FilledSlot,.LastSlot,.emptySlot{height:inherit;padding:5px}.FilledSlot span{margin:inherit!important}.qz-text-primary{color:brown}.qz-text-golden{color:#b8860b}.qz-text-green{color:green}.qz-text-teal{color:teal}.qz-box{padding:5px 10px;margin:5px 1px;border:#a9a9a9 1px solid}.qz-box-head{float:right;padding:10px 0}.qz-box-muted{background-color:#d3d3d3}.qz-box .qz-box-content{vertical-align:middle}.qz-help-text{font-size:10px}</style>",header:function(){return e(i.P,"qz-box-head")},headerLastWeekModeOn:function(){return t("","SEMANA ANTERIOR","qz-text-primary")},headerLaborTime:function(e){return t("Efetuado: ",e,"qz-text-green")},headerBalanceTime:function(e){return t("Saldo: ",e,"qz-text-teal")},headerWeekPendingTime:function(e){return t("Pendente: ",e,"qz-text-primary")},headerExtraTime:function(e){return t("Extra: ",e,"qz-text-green")},headerWeekTimeToLeave:function(e){return t("Saída: ",e,"qz-text-primary")},balanceTimePerDay:function(t){var n=e(i.DIV,"qz-help-text","Saldo"),a=e(i.STRONG,"qz-box-content qz-text-teal",t),r=e(i.DIV,"qz-box qz-box-muted");return r.appendChild(n),r.appendChild(a),r},laborTimePerDay:function(t){var n=e(i.DIV,"qz-help-text","Efetuado"),a=e(i.STRONG,"qz-box-content qz-text-green",t),r=e(i.DIV,"qz-box qz-box-muted");return r.appendChild(n),r.appendChild(a),r},laborTimePerShift:function(t,n){var a=e(i.DIV,"qz-box qz-box-muted"),r=e(i.STRONG,"qz-box-content",t);if(!n){var o=e(i.DIV,"qz-help-text","Trabalhando...");a.appendChild(o),r.classList.add("qz-text-golden")}return a.appendChild(r),a},todayTimeToLeave:function(t){var n=e(i.DIV,"qz-help-text","Saída"),a=e(i.STRONG,"qz-box-content qz-text-primary",t),r=e(i.DIV,"qz-box qz-box-muted");return r.appendChild(n),r.appendChild(a),r}}}();e.pl.snippet=t}(Queiroz),function(e,i){var t=function(){return{append:function(i,t){var n=this;n.asyncReflow(function(){var a=n.get(i),r=e.createElement("div");"string"==typeof t?r.innerHTML=t:r.appendChild(t),a.appendChild(r)})},asyncReflow:function(e){setTimeout(e,25)},get:function(i,t){return(t||e).querySelector(i)},getAll:function(i,t){return(t||e).querySelectorAll(i)}}}();i.pl.view=t}(document,Queiroz),function(e){var i=function(){var e=function(e){return e<10?"0"+e:e};return{zero:"00:00",fake:"12:34",dateToHuman:function(i){return e(i.getHours())+":"+e(i.getMinutes())},millisToHuman:function(i){var t=parseInt(i/36e5),n=parseInt(i/6e4%60);return e(t)+":"+e(n)},diff:function(e,i){return e instanceof Date&&i instanceof Date?i.getTime()-e.getTime():i-e},hourToMillis:function(e){return 36e5*e},minuteToMillis:function(e){return 6e4*e},isToday:function(e){var i=new Date;return e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()},toDate:function(e){var i=e.split(" "),t=i[0].split("_"),n=i[1].split(":");return new Date(t[2],t[1]-1,t[0],n[0],n[1])},Weekday:{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6}}}();e.pl.time=i}(Queiroz),function(e){var i=function(){return{textFormat:function(e,i){for(var t=0;t<i.length;t++){var n=new RegExp("\\{"+t+"\\}","g");e=e.replace(n,i[t])}return e}}}();e.pl.util=i}(Queiroz),function(e){var i=e.pl.kairos,t=e.pl.view,n=e.pl.time,a=(e.pl.util,e.pl.snippet),r={INITIAL_WEEKDAY:n.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_CONSECUTIVE_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,MAX_MINUTES_PER_DAY:528,USERSCRIPT_DELAY_MILLIS:1e3},o={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao",FOOTER:"footer label"},l=function(){return n.hourToMillis(r.MAX_HOURS_PER_WEEK)},m=function(){return n.hourToMillis(r.MAX_CONSECUTIVE_HOURS_PER_DAY)},u=function(){return n.minuteToMillis(r.MAX_MINUTES_PER_DAY)},d={week:{laborTime:{millis:0,human:"",html:""},balanceTime:{millis:0,human:"",html:""},pendingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computePendingTimeInMillis:function(){return l()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-l()},_buildHumanBalanceTime:function(){var e=this.balanceTime.millis;return 0==e?n.zero:e>0?"+"+n.millisToHuman(e):e<0?"-"+n.millisToHuman(-1*e):void 0},buildTime:function(){this.pendingTime.millis=this._computePendingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=n.millisToHuman(this.laborTime.millis),this.balanceTime.human=this._buildHumanBalanceTime(),this.pendingTime.human=n.millisToHuman(this.pendingTime.millis>0?this.pendingTime.millis:0),this.extraTime.human=n.millisToHuman(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=a.headerLaborTime(this.laborTime.human),this.balanceTime.html=a.headerBalanceTime(this.balanceTime.human),this.pendingTime.html=a.headerWeekPendingTime(this.pendingTime.human),this.extraTime.html=a.headerExtraTime(this.extraTime.human)}},today:{laborTime:{millis:0}}},T="",s=function(e){return t.getAll(o.CHECKPOINT,e)},c=function(e){return t.get(o.DATE,e).value},p=function(){if(d.week.pendingTime.millis<=0)return"";if(d.week.pendingTime.millis>u())return"";var e="";if(T){var i=T.getTime()+d.week.pendingTime.millis;if(!i||i<(new Date).getTime())return"";var t=n.dateToHuman(new Date(i));e=a.headerWeekTimeToLeave(t)}return e},h=function(){return d.week.pendingTime.millis>=0?d.week.pendingTime.html:d.week.extraTime.html},f=function(e){var i=a.header();return e.forEach(function(e){e&&i.appendChild(e)}),i},E=function(){d.week.buildHumanTime(),d.week.buildHtmlTime();var e=r.LAST_WEEK_MODE?a.headerLastWeekModeOn():"",i=h(),n=p(),l=[e,d.week.laborTime.html,d.week.balanceTime.html,i,n],m=f(l);t.append(o.HEADER,m)},D=function(){"ON"===r.LAST_WEEK_MODE&&(r.LAST_WEEK_MODE="DOING"),d.week.buildTime(),"DOING"!==r.LAST_WEEK_MODE&&E()},b=function(e,i,t){i<0&&(i=0);var r=n.millisToHuman(i),o=a.laborTimePerShift(r,t);document.createElement("div").appendChild(o);var l=e.parentNode;l.parentNode.insertBefore(o,l.nextSibling)},x=function(e,i){var t=n.millisToHuman(i);e.appendChild(a.laborTimePerDay(t))},g=function(e,i){var t=n.isToday(n.toDate(c(e)+" "+n.fake)),r=u(),o=0,l=n.zero;i<r?(o=r-i,l="-"+n.millisToHuman(o),0==t&&(d.week.balanceTime.millis-=o)):i>r&&(o=i-r,l="+"+n.millisToHuman(o),0==t&&(d.week.balanceTime.millis+=o)),0==t&&e.appendChild(a.balanceTimePerDay(l))},S=function(e,i){var t=u()-d.today.laborTime.millis,r=i+(t<0?0:t),o=n.dateToHuman(new Date(r)),l=a.todayTimeToLeave(o),m=e.parentNode;m.parentNode.insertBefore(l,m.nextSibling)},_=function(e){var i=s(e);if(i.length){var a=0;t.getAll(o.TIME_IN,e).forEach(function(t,o){var s=t.textContent,p=n.toDate(c(e)+" "+s),h=i[2*o+1];if(h&&!h.parentElement.classList.contains("LastSlot")){var f=h.textContent,E=n.toDate(c(e)+" "+f),D=n.diff(p,E);a+=D,"DOING"!==r.LAST_WEEK_MODE&&b(h,D,!0),n.isToday(p)&&(d.today.laborTime.millis+=D)}else{T=p,n.isToday(p)&&l()-d.week.laborTime.millis>u()&&S(t,p.getTime());var x=n.diff(p,new Date);x<m()&&b(t,a+x,!1)}}),a>0&&(d.week.laborTime.millis+=a,x(e,a)),g(e,a)}},v=function(){var e=[],i=!1;return t.getAll(o.COLUMN_DAY).forEach(function(t){var a=c(t)+" "+n.fake,o=n.toDate(a);0===d.week.laborTime.millis?(i||(i=o.getDay()===r.INITIAL_WEEKDAY))&&e.push(t):o.getDay()===r.INITIAL_WEEKDAY?r.LAST_WEEK_MODE="DONE":"DOING"===r.LAST_WEEK_MODE&&e.push(t)}),e},A=function(){t.append("head",a.STYLE),v().forEach(_),D(),"DOING"===r.LAST_WEEK_MODE&&(i.nextWeek(),setTimeout(z,1e3))},z=function(){var e=setInterval(function(){t.get(o.CHECKPOINT)&&(clearInterval(e),A())},r.USERSCRIPT_DELAY_MILLIS)};e.bless=function(e){return r.LAST_WEEK_MODE=!!e&&"ON","ON"===r.LAST_WEEK_MODE?(i.backWeek(),setTimeout(z,1e3)):t.get(o.CHECKPOINT)?A():z(),t.get(o.FOOTER).textContent+=" | "+this.description,this.description}}(Queiroz),Queiroz.bless();