
/*!
 * Queiroz.js 2.6.13
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(e){var t=function(){return{append:function(e,t){var i=this;i.asyncReflow(function(){var n=i.get(e),r=document.createElement("div");r.innerHTML=t,n.appendChild(r)})},asyncReflow:function(e){setTimeout(e,25)},get:function(e,t){return(t||document).querySelector(e)},getAll:function(e,t){return(t||document).querySelectorAll(e)}}}();e.view=t}(window),function(e){var t=function(){var e={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},t=function(e){return e<10?"0"+e:e},i=function(){return{toMillis:function(e){return e*r.IN_HOUR}}}(),n=function(){return{toMillis:function(e){return e*r.IN_MINUTE}}}(),r=function(){return{IN_MINUTE:6e4,IN_HOUR:36e5,diff:function(e,t){return e instanceof Date&&t instanceof Date?t.getTime()-e.getTime():t-e},toHumanTime:function(e){var i=parseInt(e/36e5),n=parseInt(e/6e4%60);return t(i)+":"+t(n)}}}();return{Hour:i,Minute:n,Millis:r,Weekday:e,toDate:function(e){var t=e.split(" "),i=t[0].split("_"),n=t[1].split(":");return new Date(i[2],i[1]-1,i[0],n[0],n[1])},dateToHumanTime:function(e){return t(e.getHours())+":"+t(e.getMinutes())}}}();e.time=t}(window),function(e){var t=function(){return{textFormat:function(e,t){for(var i=0;i<t.length;i++){var n=new RegExp("\\{"+i+"\\}","g");e=e.replace(n,t[i])}return e}}}();e.util=t}(window),function(e,t,i,n){var r=function(){var e={INITIAL_WEEKDAY:i.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,NORMAL_MINUTES_PER_DAY:528,TAMPERMONKEY_DELAY_MILLIS:1e3},r={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao"},o={HEADER:'<p class="qz-box qz-box-head qz-box-muted">{0}{1}{2}{3}</p>',HEADER_LAST_WEEK_MODE_ON:'<strong class="qz-text-primary">SEMANA ANTERIOR</strong>  |  ',HEADER_LABOR_TIME:'Total: <strong class="qz-text-primary">{0}</strong>',HEADER_MISSING_TIME:'  |  Faltam: <strong class="qz-text-primary">{0}</strong>',HEADER_EXTRA_TIME:'  |  Extra: <strong class="qz-text-primary">{0}</strong>',HEADER_TIME_TO_LEAVE:'  |  Sa√≠da/Fim: <strong class="qz-text-primary">{0}</strong>',LABOR_TIME_PER_DAY:'<div class="qz-box qz-box-muted"><strong class="qz-box-content qz-text-primary">{0}</strong></div>',LABOR_TIME_PER_SHIFT:'<div class="qz-box qz-box-muted"><strong class="qz-box-content">{0}</strong></div>',STYLE:"<style>strong{font-weight:bold;}.ContentTable {margin-top:inherit;}.emptySlot,.FilledSlot,.LastSlot {height:inherit;padding:5px;}.qz-text-primary {color:brown;}.qz-box {padding:7px;margin:5px 1px;}.qz-box-head {float:right;padding:10px;}.qz-box-muted {background-color:lightgray;}.qz-box .qz-box-content {margin-left:6px; vertical-align:middle;}</style>"},l=function(){return i.Hour.toMillis(e.MAX_HOURS_PER_WEEK)},a=function(){return i.Hour.toMillis(e.MAX_HOURS_PER_DAY)},m=function(){return i.Minute.toMillis(e.NORMAL_MINUTES_PER_DAY)},s={week:{laborTime:{millis:0,human:"",html:""},missingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:_computeMissingTimeInMillis=function(){return l()-s.week.laborTime.millis},_computeExtraTimeInMillis:_computeExtraTimeInMillis=function(){return s.week.laborTime.millis-l()},buildTime:function(){s.week.missingTime.millis=s.week._computeMissingTimeInMillis(),s.week.extraTime.millis=s.week._computeExtraTimeInMillis()},buildHumanTime:function(){s.week.laborTime.human=i.Millis.toHumanTime(s.week.laborTime.millis),s.week.missingTime.human=i.Millis.toHumanTime(s.week.missingTime.millis>0?s.week.missingTime.millis:0),s.week.extraTime.human=i.Millis.toHumanTime(s.week.extraTime.millis>0?s.week.extraTime.millis:0)},buildHtmlTime:function(){s.week.laborTime.html=n.textFormat(o.HEADER_LABOR_TIME,[s.week.laborTime.human]),s.week.missingTime.html=n.textFormat(o.HEADER_MISSING_TIME,[s.week.missingTime.human]),s.week.extraTime.html=n.textFormat(o.HEADER_EXTRA_TIME,[s.week.extraTime.human])}}},u="",E=function(e){return t.getAll(r.CHECKPOINT,e)},T=function(e){return t.get(r.DATE,e).value},_=function(){if(s.week.missingTime.millis<=0)return"";if(s.week.missingTime.millis>m())return"";var e="";if(u){var t=u.getTime()+s.week.missingTime.millis;if(!t||t<(new Date).getTime())return"";var r=i.dateToHumanTime(new Date(t));e=n.textFormat(o.HEADER_TIME_TO_LEAVE,[r])}return e},c=function(){s.week.buildHumanTime(),s.week.buildHtmlTime();var i=e.LAST_WEEK_MODE?o.HEADER_LAST_WEEK_MODE_ON:"",l=_(s.week.missingTime.millis),a=[i,s.week.laborTime.html,s.week.missingTime.millis>=0?s.week.missingTime.html:s.week.extraTime.html,l],m=n.textFormat(o.HEADER,a);t.append(r.HEADER,m)},A=function(){"ON"===e.LAST_WEEK_MODE&&(e.LAST_WEEK_MODE="DOING"),s.week.buildTime(),"DOING"!==e.LAST_WEEK_MODE&&c()},M=function(e,t){var r=i.Millis.toHumanTime(t),l=n.textFormat(o.LABOR_TIME_PER_SHIFT,[r]),a=document.createElement("div");a.innerHTML=l;var m=e.parentNode;return m.parentNode.insertBefore(a,m.nextSibling),a},f=function(e,t){var r=i.Millis.toHumanTime(t);e.innerHTML+=n.textFormat(o.LABOR_TIME_PER_DAY,[r])},D=function(n){var o=E(n);if(o.length){var l=0;t.getAll(r.TIME_IN,n).forEach(function(t,r){var m=t.textContent,s=i.toDate(T(n)+" "+m),E=o[2*r+1];if(E&&!E.parentElement.classList.contains("LastSlot")){var _=E.textContent,c=i.toDate(T(n)+" "+_),A=i.Millis.diff(s,c);l+=A,"DOING"!==e.LAST_WEEK_MODE&&M(E,A)}else{u=s;var f=i.Millis.diff(s,new Date);if(f<a()){var D=M(t,A=l+f),g=D.querySelector("strong");D.style.color="darkgoldenrod",g.textContent="~ "+g.textContent}}}),s.week.laborTime.millis+=l,f(n,l)}},g=function(){var n=[],o=!1;return t.getAll(r.COLUMN_DAY).forEach(function(t){var r=T(t)+" 12:34",l=i.toDate(r);0===s.week.laborTime.millis?(o||(o=l.getDay()===e.INITIAL_WEEKDAY))&&n.push(t):l.getDay()===e.INITIAL_WEEKDAY?e.LAST_WEEK_MODE="DONE":"DOING"===e.LAST_WEEK_MODE&&n.push(t)}),n},I=function(){t.append("head",o.STYLE),g().forEach(D),A(),"DOING"===e.LAST_WEEK_MODE&&(mudarSemana(1,!0),setTimeout(d,1e3))},d=function(){var i=setInterval(function(){t.get(r.CHECKPOINT)&&(clearInterval(i),I())},e.TAMPERMONKEY_DELAY_MILLIS)};return{bless:function(i){return e.LAST_WEEK_MODE=!!i&&"ON","ON"===e.LAST_WEEK_MODE?(mudarSemana(-1,!0),setTimeout(d,1e3)):t.get(r.CHECKPOINT)?I():d(),"Queiroz.js 2.6.13"},name:"Queiroz.js",version:"2.6.13"}}();e.Queiroz=r}(window,view,time,util),Queiroz.bless();