
/*!
 * Queiroz.js 2.6.14
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(t){var i=function(){return{append:function(t,i){var e=this;e.asyncReflow(function(){var n=e.get(t),r=document.createElement("div");r.innerHTML=i,n.appendChild(r)})},asyncReflow:function(t){setTimeout(t,25)},get:function(t,i){return(i||document).querySelector(t)},getAll:function(t,i){return(i||document).querySelectorAll(t)}}}();t.view=i}(window),function(t){var i=function(){var t={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6},i=function(t){return t<10?"0"+t:t},e=function(){return{toMillis:function(t){return t*r.IN_HOUR}}}(),n=function(){return{toMillis:function(t){return t*r.IN_MINUTE}}}(),r=function(){return{IN_MINUTE:6e4,IN_HOUR:36e5,diff:function(t,i){return t instanceof Date&&i instanceof Date?i.getTime()-t.getTime():i-t},toHumanTime:function(t){var e=parseInt(t/36e5),n=parseInt(t/6e4%60);return i(e)+":"+i(n)}}}();return{Hour:e,Minute:n,Millis:r,Weekday:t,toDate:function(t){var i=t.split(" "),e=i[0].split("_"),n=i[1].split(":");return new Date(e[2],e[1]-1,e[0],n[0],n[1])},dateToHumanTime:function(t){return i(t.getHours())+":"+i(t.getMinutes())}}}();t.time=i}(window),function(t){var i=function(){return{textFormat:function(t,i){for(var e=0;e<i.length;e++){var n=new RegExp("\\{"+e+"\\}","g");t=t.replace(n,i[e])}return t}}}();t.util=i}(window),function(t,i,e,n){var r=function(){var t={INITIAL_WEEKDAY:e.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,NORMAL_MINUTES_PER_DAY:528,TAMPERMONKEY_DELAY_MILLIS:1e3},r={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao"},o={HEADER:'<p class="qz-box qz-box-head qz-box-muted">{0}{1}{2}{3}</p>',HEADER_LAST_WEEK_MODE_ON:'<strong class="qz-text-primary">SEMANA ANTERIOR</strong>  |  ',HEADER_LABOR_TIME:'Total: <strong class="qz-text-primary">{0}</strong>',HEADER_MISSING_TIME:'  |  Faltam: <strong class="qz-text-primary">{0}</strong>',HEADER_EXTRA_TIME:'  |  Extra: <strong class="qz-text-primary">{0}</strong>',HEADER_TIME_TO_LEAVE:'  |  Sa√≠da/Fim: <strong class="qz-text-primary">{0}</strong>',LABOR_TIME_PER_DAY:'<div class="qz-box qz-box-muted"><strong class="qz-box-content qz-text-primary">{0}</strong></div>',LABOR_TIME_PER_SHIFT:'<div class="qz-box qz-box-muted"><strong class="qz-box-content">{0}</strong></div>',STYLE:"<style>strong{font-weight:bold;}.ContentTable {margin-top:inherit;}.emptySlot,.FilledSlot,.LastSlot {height:inherit;padding:5px;}.qz-text-primary {color:brown;}.qz-box {padding:7px;margin:5px 1px;}.qz-box-head {float:right;padding:10px;}.qz-box-muted {background-color:lightgray;}.qz-box .qz-box-content {margin-left:6px; vertical-align:middle;}</style>"},a=function(){return e.Hour.toMillis(t.MAX_HOURS_PER_WEEK)},l=function(){return e.Hour.toMillis(t.MAX_HOURS_PER_DAY)},m=function(){return e.Minute.toMillis(t.NORMAL_MINUTES_PER_DAY)},s={week:{laborTime:{millis:0,human:"",html:""},missingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computeMissingTimeInMillis:function(){return a()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-a()},buildTime:function(){this.missingTime.millis=this._computeMissingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=e.Millis.toHumanTime(this.laborTime.millis),this.missingTime.human=e.Millis.toHumanTime(this.missingTime.millis>0?this.missingTime.millis:0),this.extraTime.human=e.Millis.toHumanTime(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=n.textFormat(o.HEADER_LABOR_TIME,[this.laborTime.human]),this.missingTime.html=n.textFormat(o.HEADER_MISSING_TIME,[this.missingTime.human]),this.extraTime.html=n.textFormat(o.HEADER_EXTRA_TIME,[this.extraTime.human])}}},u="",E=function(t){return i.getAll(r.CHECKPOINT,t)},T=function(t){return i.get(r.DATE,t).value},_=function(){if(s.week.missingTime.millis<=0)return"";if(s.week.missingTime.millis>m())return"";var t="";if(u){var i=u.getTime()+s.week.missingTime.millis;if(!i||i<(new Date).getTime())return"";var r=e.dateToHumanTime(new Date(i));t=n.textFormat(o.HEADER_TIME_TO_LEAVE,[r])}return t},c=function(){s.week.buildHumanTime(),s.week.buildHtmlTime();var e=t.LAST_WEEK_MODE?o.HEADER_LAST_WEEK_MODE_ON:"",a=_(s.week.missingTime.millis),l=[e,s.week.laborTime.html,s.week.missingTime.millis>=0?s.week.missingTime.html:s.week.extraTime.html,a],m=n.textFormat(o.HEADER,l);i.append(r.HEADER,m)},A=function(){"ON"===t.LAST_WEEK_MODE&&(t.LAST_WEEK_MODE="DOING"),s.week.buildTime(),"DOING"!==t.LAST_WEEK_MODE&&c()},M=function(t,i){var r=e.Millis.toHumanTime(i),a=n.textFormat(o.LABOR_TIME_PER_SHIFT,[r]),l=document.createElement("div");l.innerHTML=a;var m=t.parentNode;return m.parentNode.insertBefore(l,m.nextSibling),l},f=function(t,i){var r=e.Millis.toHumanTime(i);t.innerHTML+=n.textFormat(o.LABOR_TIME_PER_DAY,[r])},D=function(n){var o=E(n);if(o.length){var a=0;i.getAll(r.TIME_IN,n).forEach(function(i,r){var m=i.textContent,s=e.toDate(T(n)+" "+m),E=o[2*r+1];if(E&&!E.parentElement.classList.contains("LastSlot")){var _=E.textContent,c=e.toDate(T(n)+" "+_),A=e.Millis.diff(s,c);a+=A,"DOING"!==t.LAST_WEEK_MODE&&M(E,A)}else{u=s;var f=e.Millis.diff(s,new Date);if(f<l()){var D=M(i,A=a+f),g=D.querySelector("strong");D.style.color="darkgoldenrod",g.textContent="~ "+g.textContent}}}),s.week.laborTime.millis+=a,f(n,a)}},g=function(){var n=[],o=!1;return i.getAll(r.COLUMN_DAY).forEach(function(i){var r=T(i)+" 12:34",a=e.toDate(r);0===s.week.laborTime.millis?(o||(o=a.getDay()===t.INITIAL_WEEKDAY))&&n.push(i):a.getDay()===t.INITIAL_WEEKDAY?t.LAST_WEEK_MODE="DONE":"DOING"===t.LAST_WEEK_MODE&&n.push(i)}),n},I=function(){i.append("head",o.STYLE),g().forEach(D),A(),"DOING"===t.LAST_WEEK_MODE&&(mudarSemana(1,!0),setTimeout(d,1e3))},d=function(){var e=setInterval(function(){i.get(r.CHECKPOINT)&&(clearInterval(e),I())},t.TAMPERMONKEY_DELAY_MILLIS)};return{bless:function(e){return t.LAST_WEEK_MODE=!!e&&"ON","ON"===t.LAST_WEEK_MODE?(mudarSemana(-1,!0),setTimeout(d,1e3)):i.get(r.CHECKPOINT)?I():d(),"Queiroz.js 2.6.14"},name:"Queiroz.js",version:"2.6.14"}}();t.Queiroz=r}(window,view,time,util),Queiroz.bless();