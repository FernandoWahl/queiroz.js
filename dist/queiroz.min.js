
/*!
 * Queiroz.js 2.8.13
 * JavaScript Extension for Dimep Kairos
 * https://github.com/viniciusknob/queiroz.js
 */

!function(e){var i={name:"Queiroz.js",version:"2.8.13",description:"Queiroz.js 2.8.13",module:{}};e.Queiroz=i}(window),function(e,i){var n=function(){return{backWeek:function(){e.mudarSemana(-1,!0)},nextWeek:function(){e.mudarSemana(1,!0)}}}();i.module.kairos=n}(window,Queiroz),function(e,i){var n=function(e){return n._[e]};n._=i,e.module.strings=n}(Queiroz,{hLastWeek:"SEMANA PASSADA",hLabor:"Efetuado: ",hBalance:"Saldo: ",hPending:"Pendente: ",hExtra:"Extra: ",hExit:"Saída: ",balance:"Saldo",labor:"Efetuado",working:"Trabalhando...",exit:"Saída"}),function(e){var i={CSS:"strong{font-weight:700}#SemanaApontamentos{cursor:default!important}.ContentTable{margin-top:inherit}.FilledSlot,.LastSlot,.emptySlot{height:inherit;padding:5px}.FilledSlot span{margin:inherit!important}.qz-text-primary{color:brown}.qz-text-golden{color:#b8860b}.qz-text-green{color:green}.qz-text-teal{color:teal}.qz-box{padding:5px 10px;margin:5px 1px;border:#a9a9a9 1px solid}.qz-box-head{float:right;padding:10px 0}.qz-box-muted{background-color:#d3d3d3}.qz-box .qz-box-content{vertical-align:middle}.qz-help-text{font-size:10px}"};e.module.style=i}(Queiroz),function(e){var i=e.module.strings,n=e.module.style,t={DIV:"div",P:"p",SPAN:"span",STYLE:"style",STRONG:"strong"},a=function(){var e=function(e,i,n){var t=document.createElement(e);if(i&&(t.className=i),n){var a=document.createTextNode(n);t.appendChild(a)}return t},a=function(i,n,a){var r=e(t.SPAN,"qz-box qz-box-muted",i),o=e(t.STRONG,a,n);return r.appendChild(o),r};return{style:function(){return e(t.STYLE,"",n.CSS)},header:function(){return e(t.P,"qz-box-head")},headerLastWeekModeOn:function(){return a("",i("hLastWeek"),"qz-text-primary")},headerLaborTime:function(e){return a(i("hLabor"),e,"qz-text-green")},headerBalanceTime:function(e){return a(i("hBalance"),e,"qz-text-teal")},headerWeekPendingTime:function(e){return a(i("hPending"),e,"qz-text-primary")},headerExtraTime:function(e){return a(i("hExtra"),e,"qz-text-green")},headerWeekTimeToLeave:function(e){return a(i("hExit"),e,"qz-text-primary")},balanceTimePerDay:function(n){var a=e(t.DIV,"qz-help-text",i("balance")),r=e(t.STRONG,"qz-box-content qz-text-teal",n),o=e(t.DIV,"qz-box qz-box-muted");return o.appendChild(a),o.appendChild(r),o},laborTimePerDay:function(n){var a=e(t.DIV,"qz-help-text",i("labor")),r=e(t.STRONG,"qz-box-content qz-text-green",n),o=e(t.DIV,"qz-box qz-box-muted");return o.appendChild(a),o.appendChild(r),o},laborTimePerShift:function(n,a){var r=e(t.DIV,"qz-box qz-box-muted"),o=e(t.STRONG,"qz-box-content",n);if(!a){var l=e(t.DIV,"qz-help-text",i("working"));r.appendChild(l),o.classList.add("qz-text-golden")}return r.appendChild(o),r},todayTimeToLeave:function(n){var a=e(t.DIV,"qz-help-text",i("exit")),r=e(t.STRONG,"qz-box-content qz-text-primary",n),o=e(t.DIV,"qz-box qz-box-muted");return o.appendChild(a),o.appendChild(r),o}}}();e.module.snippet=a}(Queiroz),function(e,i){var n=function(){return{append:function(i,n){var t=this;t.asyncReflow(function(){var a=t.get(i),r=e.createElement("div");"string"==typeof n?r.innerHTML=n:r.appendChild(n),a.appendChild(r)})},asyncReflow:function(e){setTimeout(e,25)},get:function(i,n){return(n||e).querySelector(i)},getAll:function(i,n){return(n||e).querySelectorAll(i)}}}();i.module.view=n}(document,Queiroz),function(e){var i=function(){var e=function(e){return e<10?"0"+e:e};return{zero:"00:00",fake:"12:34",dateToHuman:function(i){return e(i.getHours())+":"+e(i.getMinutes())},millisToHuman:function(i){var n=parseInt(i/36e5),t=parseInt(i/6e4%60);return e(n)+":"+e(t)},diff:function(e,i){return e instanceof Date&&i instanceof Date?i.getTime()-e.getTime():i-e},hourToMillis:function(e){return 36e5*e},minuteToMillis:function(e){return 6e4*e},isToday:function(e){var i=new Date;return e.getDate()===i.getDate()&&e.getMonth()===i.getMonth()&&e.getFullYear()===i.getFullYear()},toDate:function(e){var i=e.split(" "),n=i[0].split("_"),t=i[1].split(":");return new Date(n[2],n[1]-1,n[0],t[0],t[1])},Weekday:{SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6}}}();e.module.time=i}(Queiroz),function(e){var i=function(){return{textFormat:function(e,i){for(var n=0;n<i.length;n++){var t=new RegExp("\\{"+n+"\\}","g");e=e.replace(t,i[n])}return e}}}();e.module.util=i}(Queiroz),function(e){var i=e.module,n=i.kairos,t=i.view,a=i.time,r=(i.util,i.snippet),o={INITIAL_WEEKDAY:a.Weekday.MONDAY,LAST_WEEK_MODE:!1,MAX_CONSECUTIVE_HOURS_PER_DAY:6,MAX_HOURS_PER_WEEK:44,MAX_MINUTES_PER_DAY:528,USERSCRIPT_DELAY_MILLIS:1e3},l={COLUMN_DAY:".DiaApontamento",CHECKPOINT:".FilledSlot span",DATE:"[id^=hiddenDiaApont]",HEADER:"#SemanaApontamentos div",TIME_IN:".TimeIN,.TimeINVisualizacao",FOOTER:"footer .LabelEmpresa"},u=function(){return a.hourToMillis(o.MAX_HOURS_PER_WEEK)},m=function(){return a.hourToMillis(o.MAX_CONSECUTIVE_HOURS_PER_DAY)},d=function(){return a.minuteToMillis(o.MAX_MINUTES_PER_DAY)},T={week:{laborTime:{millis:0,human:"",html:""},balanceTime:{millis:0,human:"",html:""},pendingTime:{millis:0,human:"",html:""},extraTime:{millis:0,human:"",html:""},_computePendingTimeInMillis:function(){return u()-this.laborTime.millis},_computeExtraTimeInMillis:function(){return this.laborTime.millis-u()},_buildHumanBalanceTime:function(){var e=this.balanceTime.millis;return 0==e?a.zero:e>0?"+"+a.millisToHuman(e):e<0?"-"+a.millisToHuman(-1*e):void 0},buildTime:function(){this.pendingTime.millis=this._computePendingTimeInMillis(),this.extraTime.millis=this._computeExtraTimeInMillis()},buildHumanTime:function(){this.laborTime.human=a.millisToHuman(this.laborTime.millis),this.balanceTime.human=this._buildHumanBalanceTime(),this.pendingTime.human=a.millisToHuman(this.pendingTime.millis>0?this.pendingTime.millis:0),this.extraTime.human=a.millisToHuman(this.extraTime.millis>0?this.extraTime.millis:0)},buildHtmlTime:function(){this.laborTime.html=r.headerLaborTime(this.laborTime.human),this.balanceTime.html=r.headerBalanceTime(this.balanceTime.human),this.pendingTime.html=r.headerWeekPendingTime(this.pendingTime.human),this.extraTime.html=r.headerExtraTime(this.extraTime.human)}},today:{laborTime:{millis:0}}},s="",c=function(e){return t.getAll(l.CHECKPOINT,e)},h=function(e){return t.get(l.DATE,e).value},f=function(){if(T.week.pendingTime.millis<=0)return"";if(T.week.pendingTime.millis>d())return"";var e="";if(s){var i=s.getTime()+T.week.pendingTime.millis;if(!i||i<(new Date).getTime())return"";var n=a.dateToHuman(new Date(i));e=r.headerWeekTimeToLeave(n)}return e},p=function(){return T.week.pendingTime.millis>=0?T.week.pendingTime.html:T.week.extraTime.html},E=function(e){var i=r.header();return e.forEach(function(e){e&&i.appendChild(e)}),i},b=function(){T.week.buildHumanTime(),T.week.buildHtmlTime();var e=o.LAST_WEEK_MODE?r.headerLastWeekModeOn():"",i=p(),n=f(),a=[e,T.week.laborTime.html,T.week.balanceTime.html,i,n],u=E(a);t.append(l.HEADER,u)},x=function(){"ON"===o.LAST_WEEK_MODE&&(o.LAST_WEEK_MODE="DOING"),T.week.buildTime(),"DOING"!==o.LAST_WEEK_MODE&&b()},g=function(e,i,n){i<0&&(i=0);var t=a.millisToHuman(i),o=r.laborTimePerShift(t,n);document.createElement("div").appendChild(o);var l=e.parentNode;l.parentNode.insertBefore(o,l.nextSibling)},D=function(e,i){var n=a.millisToHuman(i);e.appendChild(r.laborTimePerDay(n))},_=function(e,i){var n=a.isToday(a.toDate(h(e)+" "+a.fake)),t=d(),o=0,l=a.zero;i<t?(o=t-i,l="-"+a.millisToHuman(o),0==n&&(T.week.balanceTime.millis-=o)):i>t&&(o=i-t,l="+"+a.millisToHuman(o),0==n&&(T.week.balanceTime.millis+=o)),0==n&&e.appendChild(r.balanceTimePerDay(l))},S=function(e,i){var n=d()-T.today.laborTime.millis,t=i+(n<0?0:n),o=a.dateToHuman(new Date(t)),l=r.todayTimeToLeave(o),u=e.parentNode;u.parentNode.insertBefore(l,u.nextSibling)},v=function(e){var i=c(e);if(i.length){var n=0;t.getAll(l.TIME_IN,e).forEach(function(t,r){var l=t.textContent,c=a.toDate(h(e)+" "+l),f=i[2*r+1];if(f&&!f.parentElement.classList.contains("LastSlot")){var p=f.textContent,E=a.toDate(h(e)+" "+p),b=a.diff(c,E);n+=b,"DOING"!==o.LAST_WEEK_MODE&&g(f,b,!0),a.isToday(c)&&(T.today.laborTime.millis+=b)}else{s=c,a.isToday(c)&&u()-T.week.laborTime.millis>d()&&S(t,c.getTime());var x=a.diff(c,new Date);x<m()&&g(t,n+x,!1)}}),n>0&&(T.week.laborTime.millis+=n,D(e,n)),_(e,n)}},A=function(){var e=[],i=!1;return t.getAll(l.COLUMN_DAY).forEach(function(n){var t=h(n)+" "+a.fake,r=a.toDate(t);0===T.week.laborTime.millis?(i||(i=r.getDay()===o.INITIAL_WEEKDAY))&&e.push(n):r.getDay()===o.INITIAL_WEEKDAY?o.LAST_WEEK_MODE="DONE":"DOING"===o.LAST_WEEK_MODE&&e.push(n)}),e},z=function(){t.append("head",r.style()),A().forEach(v),x(),"DOING"===o.LAST_WEEK_MODE&&(n.nextWeek(),setTimeout(I,1e3))},I=function(){var e=setInterval(function(){t.get(l.CHECKPOINT)&&(clearInterval(e),z())},o.USERSCRIPT_DELAY_MILLIS)};e.bless=function(e){return o.LAST_WEEK_MODE=!!e&&"ON","ON"===o.LAST_WEEK_MODE?(n.backWeek(),setTimeout(I,1e3)):t.get(l.CHECKPOINT)?z():I(),t.get(l.FOOTER).textContent+=" | "+this.description,this.description}}(Queiroz),Queiroz.bless();